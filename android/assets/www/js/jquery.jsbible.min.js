/*!
 * JS Bible v1.0
 * A jQuery Bible widget for your website
 * http://www.jonsuh.com/jsbible
 * 
 * Copyright (c) 2013 Jonathan Suh
 * Free to use under the MIT license.
 * http://opensource.org/licenses/MIT
 */
(function(e){e.jsbible=function(t,n){var r={api:"",version:"kjv",red_letter:true,persistent_chapter:false,scrolltop:true,scrolltop_text:"Back to Top",scrolltop_speed:250},i=this;i.settings={};var s=e(t),o=t,u=[{name:"Genesis",chapters:50,testament:"old"},{name:"Exodus",chapters:50,testament:"old"},{name:"Leviticus",chapters:27,testament:"old"},{name:"Numbers",chapters:36,testament:"old"},{name:"Deuteronomy",chapters:34,testament:"old"},{name:"Joshua",chapters:24,testament:"old"},{name:"Judges",chapters:21,testament:"old"},{name:"Ruth",chapters:4,testament:"old"},{name:"1 Samuel",chapters:31,testament:"old"},{name:"2 Samuel",chapters:24,testament:"old"},{name:"1 Kings",chapters:22,testament:"old"},{name:"2 Kings",chapters:25,testament:"old"},{name:"1 Chronicles",chapters:29,testament:"old"},{name:"2 Chronicles",chapters:36,testament:"old"},{name:"Ezra",chapters:10,testament:"old"},{name:"Nehemiah",chapters:13,testament:"old"},{name:"Esther",chapters:10,testament:"old"},{name:"Job",chapters:42,testament:"old"},{name:"Psalms",chapters:150,testament:"old"},{name:"Proverbs",chapters:31,testament:"old"},{name:"Ecclesiastes",chapters:12,testament:"old"},{name:"Song of Solomon",chapters:8,testament:"old"},{name:"Isaiah",chapters:66,testament:"old"},{name:"Jeremiah",chapters:52,testament:"old"},{name:"Lamentations",chapters:5,testament:"old"},{name:"Ezekiel",chapters:48,testament:"old"},{name:"Daniel",chapters:12,testament:"old"},{name:"Hosea",chapters:14,testament:"old"},{name:"Joel",chapters:3,testament:"old"},{name:"Amos",chapters:9,testament:"old"},{name:"Obadiah",chapters:1,testament:"old"},{name:"Jonah",chapters:4,testament:"old"},{name:"Micah",chapters:7,testament:"old"},{name:"Nahum",chapters:3,testament:"old"},{name:"Habakkuk",chapters:3,testament:"old"},{name:"Zephaniah",chapters:3,testament:"old"},{name:"Haggai",chapters:2,testament:"old"},{name:"Zechariah",chapters:14,testament:"old"},{name:"Malachi",chapters:4,testament:"old"},{name:"Matthew",chapters:28,testament:"new"},{name:"Mark",chapters:16,testament:"new"},{name:"Luke",chapters:24,testament:"new"},{name:"John",chapters:21,testament:"new"},{name:"Acts",chapters:28,testament:"new"},{name:"Romans",chapters:16,testament:"new"},{name:"1 Corinthians",chapters:16,testament:"new"},{name:"2 Corinthians",chapters:13,testament:"new"},{name:"Galatians",chapters:6,testament:"new"},{name:"Ephesians",chapters:6,testament:"new"},{name:"Philippians",chapters:4,testament:"new"},{name:"Colossians",chapters:4,testament:"new"},{name:"1 Thessalonians",chapters:5,testament:"new"},{name:"2 Thessalonians",chapters:3,testament:"new"},{name:"1 Timothy",chapters:6,testament:"new"},{name:"2 Timothy",chapters:4,testament:"new"},{name:"Titus",chapters:3,testament:"new"},{name:"Philemon",chapters:1,testament:"new"},{name:"Hebrews",chapters:13,testament:"new"},{name:"James",chapters:5,testament:"new"},{name:"1 Peter",chapters:5,testament:"new"},{name:"2 Peter",chapters:3,testament:"new"},{name:"1 John",chapters:5,testament:"new"},{name:"2 John",chapters:1,testament:"new"},{name:"3 John",chapters:1,testament:"new"},{name:"Jude",chapters:1,testament:"new"},{name:"Revelation",chapters:22,testament:"new"}],a;u.by_name={};for(var f=0;f<u.length;++f){a=u[f];u.by_name[a.name]=a}i.init=function(){i.settings=e.extend({},r,n);if(i.settings.api==""){s.html("API key is required.");exit}var t,o,a,f,c;t=e("<div/>",{"class":"jsbible-select"});o=e("<select/>",{"class":"jsbible-books"});a="";for(c=0;c<u.length;++c){a+='<option value="'+u[c].name+'">'+u[c].name+"</option>"}o.append(a);o.bind("change",function(){l(i.settings,e(this))});t.append(o);o=e("<select/>",{"class":"jsbible-chapters"});o.bind("change",function(){l(i.settings,e(this))});t.append(o);t.after(e("<div/>",{"class":"jsbible-text"}));s.html(t);l(i.settings,s.find(".jsbible-books"));if(i.settings.scrolltop==true){var h=e("<a/>",{href:"#jsbible-scrolltop",html:i.settings.scrolltop_text,"class":"jsbible-scrolltop"});h.on("click",function(t){e("html, body").animate({scrollTop:s.offset().top},i.settings.scrolltop_speed);return false});s.append(h)}f=e("<div/>",{"class":"jsbible-copyright",html:'<a href="http://biblia.com/"><img src="http://api.biblia.com/docs/media/PoweredByBiblia.png" alt="Powered by Biblia" /></a> This site uses the <a href="http://biblia.com/">Biblia</a> web services from <a href="http://www.logos.com/">Logos Bible Software</a>.'});s.append(f)};var l=function(t,n){if(n.hasClass("jsbible-books")){var r=s.find(".jsbible-books").val(),i=u.by_name[r].chapters,o="";for(var a=1;a<=i;a++){o+='<option value="'+a+'"';if(t.persistent_chapter==true){if(a==s.find(".jsbible-chapters").val()){o+=' selected="selected"'}}o+=">"+a+"</option>"}s.find(".jsbible-chapters").html("").append(o)}var f=s,r=f.find(".jsbible-books").val(),l=f.find(".jsbible-chapters").val(),i="",c="";if(f.find(".jsbible-chapters option").length==1){l=""}var h={passage:r+" "+l,header:"[FullPassageRef]",eachVerse:"<p><sup>[VerseNum]</sup>[VerseText]</p>",paragraphs:"false",redLetter:t.red_letter,key:t.api};h=e.param(h);e.ajax({url:"http://api.biblia.com/v1/bible/content/"+t.version+".html.json?",data:h,cache:true,dataType:"jsonp",success:function(t){e.each(t,function(){c+=t.text});f.find(".jsbible-text").html(c)},error:function(e,t){f.find(".jsbible-text").html("<p>An error occured.</p>")}})};i.init()};e.fn.jsbible=function(t){return this.each(function(){if(undefined==e(this).data("jsbible")){var n=new e.jsbible(this,t);e(this).data("jsbible",n)}})}})(jQuery)